function ProcessNPForm(){p=$("input[name=NPN]").val(),p.length<5||null==p?DisplayFormException("NPFI","Der Name muss 5 Zeichen enthalten!"):GetIndexofPlan(p)>-1?DisplayFormException("NPFI","Der Name ist schon vergeben!"):(ApiAddPlan(p,$("input[name=SDR]").val(),$("input[name=DR]").val()),HideFormException("NPFI"))}function ProccessPlanDeletion(n){$("#".concat(n)).remove(),Plans.List.splice(GetIndexofPlan(n),1)}function ProccessPlanToggling(n){document.getElementById(n.concat("-AS")).innerText=function(){return"A"===document.getElementById(n.concat("-D")).innerText?"I":"A"};var t=GetIndexofPlan(n);Plans.List[t]=function(){return Plans.List[t]!==!0}}function GetIndexofPlan(n){for(var t=0;t<Plans.List.length;t++)if(Plans.List[t].Content.Name===n)return t;return-1}function GetIndexofAction(n,t){for(var e=GetIndexofPlan(t),a=0;a<Plans.List[e].Content.Elements.length;a++)if(Plans.List[e].Content.Elements[a].Name==n)return a}function toggle_sscreen(n,t,e){GenerateSettingContent(e),$(n).css("display",function(n,t){return"none"===t?"initial":"none"}),CenterContainer(),null!=t&&HideFormException(t)}function DisplayRangeValue(n){p=n.split(" "),document.getElementById(p[0]).textContent=$("input[name="+p[1]+"]").val()}function CenterContainer(){for(var n=0;n<SSBID.length;n++)$(SSBID[n]).css("margin-top",$(SSBID[n]).height()/-2),$(SSBID[n]).css("margin-left",$(SSBID[n]).innerWidth()/-2)}function HideFormException(n){document.getElementById(n.concat("P")).textContent="",$("#".concat(n)).css("display","none")}function DisplayFormException(n,t){document.getElementById(n.concat("P")).textContent=t,$("#".concat(n)).css("display","block")}function GeneratePlanElement(n,t){var e=PlanPieces[0];e=e.concat(n),e=e.concat(PlanPieces[1]),e=e.concat(n.concat("-AS")),e=e.concat(PlanPieces[2]),e=e.concat(t).concat(PlanPieces[3]),e=e.concat(n.concat("-D")),e=e.concat(PlanPieces[4]),e=e.concat(n),e=e.concat(PlanPieces[5]),e=e.concat(n),e=e.concat(PlanPieces[6]),e=e.concat(n),e=e.concat(PlanPieces[7]),e=e.concat(n),e=e.concat(PlanPieces[8]),$("#plan-container").append(e)}function GenerateSettingContent(n){}function ApiAddPlan(n,t,e){$.ajax({method:"PUT",url:RequestUrls[1].concat("AddPlan"),data:{NewPlan:new PlanTemplate(n,t,e)},complete:function(a){200!==a.status?alert("An unhandled server Error occurred"):GeneratePlanElement(n,"Na"),Plans.List.push(new PlanWrapper(null,new Plan(n,t,e,null)))},dataType:"json"})}function ApiTogglePlan(n){$.ajax({method:"POST",url:RequestUrls[1].concat("TogglePlan"),data:{Name:n},complete:function(t){200!==t.status?alert("An unhandled server Error occurred"):ProccessPlanToggling(n)},dataType:"json"})}function ApiDeletePlan(n){$.ajax({method:"DELETE",url:RequestUrls[1].concat("DeletePlan"),data:{Name:n},complete:function(n){200!==n.status?alert("An unhandled server Error occurred"):ProccessPlanDeletion(n)},dataType:"json"})}function ApiGetAllPlans(){$.ajax({method:"GET",url:RequestUrls[1].concat("GetAllPlans"),data:{},complete:function(n){if(200===n.status){Plans=new PlansData(n.responseJSON);for(var t=0;t<Plans.List.length;t++){var e=Plans.List[t].Active===!0?"A":"I";GeneratePlanElement(Plans.List[t].Content.Name,e)}console.log(Plans)}else alert("An unhandled server Error occurred")},contentType:"application/json",dataType:"json"})}function GetPlanStatuses(){$.ajax({method:"GET",url:RequestUrls[1].concat("GetPlanStatuses"),data:{},complete:function(n){if(200===n.status)for(var t=0;t<Plans.List.length;t++)Plans.List[t].Content.Name in n.responseJSON&&(Plans.List[t].Active=n.responseJSON[Plans.List[t].Content.Name]);else alert("An unhandled server Error occurred")},contentType:"application/json",dataType:"json"})}function ApiAddAction(n,t,e,a,o){$.ajax({method:"PUT",url:RequestUrls[1].concat("AddAction"),data:{NewAction:new ActionTemplate(n,t,e,a,o)},complete:function(n){200!==n.status?alert("An unhandled server Error occurred"):Plans.List[GetIndexofPlan(t)].Content.Elements.push(new Action(n,t,e,a,o))},dataType:"json"})}function ApiDeleteAction(n,t){$.ajax({method:"DELETE",url:RequestUrls[1].concat("DeleteAction"),data:{NewAction:new ActionTemplate(n,t)},complete:function(n){200!==n.status?alert("An unhandled server Error occurred"):Plans.List[GetIndexofPlan(t)].Content.Elements.splice(GetIndexofAction(n,t),1)},dataType:"json"})}function ApiGetWarnings(){$.ajax({method:"Get",url:RequestUrls[0].concat("GetWarnings"),data:{},complete:function(n){200===n.status?alert("Not Implemented"):alert("An unhandled server Error occurred")},contentType:"application/json",dataType:"json"})}function ApiGetValveStatus(){$.ajax({method:"Get",url:RequestUrls[0].concat("GetValveStatus"),data:{},complete:function(n){200===n.status?alert("Not Implemented"):alert("An unhandled server Error occurred")},contentType:"application/json",dataType:"json"})}function ApiGetSystemStatus(){$.ajax({method:"Get",url:RequestUrls[0].concat("GetSystemStatus"),data:{},complete:function(n){200===n.status?alert("Not Implemented"):alert("An unhandled server Error occurred")},contentType:"application/json",dataType:"json"})}function Action(n,t,e,a,o){this.Name=n,this.PlanName=t,this.Duration=e,this.PrimaryCondition=a,this.SecondaryCondition=o}function Plan(n,t,e,a){this.Name=n,this.StartCondition=t,this.Duration=e,this.Elements=a}function PlanWrapper(n,t){this.Active=n,this.Content=t}function PlanTemplate(n,t,e){this.Name=n,this.StartCondition=t,this.Duration=e}function ActionTemplate(n,t,e,a,o){this.Name=n,this.PlanName=t,this.Duration=e,this.PrimaryCondition=a,this.SecondaryCondition=o}function DeleteActionTemplate(n,t){this.Name=n,this.PlanName=t}function PlansData(n){this.Created=Date.now(),this.List=n}$(document).ready(function(){ApiGetAllPlans(),setInterval(function(){},6e4)}),$(window).resize(function(){CenterContainer()}),$(window).unload(function(){localStorage.setItem("Plans",JSON.stringify(Plans))});var p,Plans,System,RequestUrls=["/api/SystemInformation/","/api/PlanAction/"],SSBID=["#SSB0","#SSB1","#SSB2"],PlanPieces=['<div class="plan" id="','"><div class="status"><h3 id="','">','</h3></div><div class="description"><p id="','">','</p></div><div class="button" onclick="javascript: ApiTogglePlan(\'',"');\"><img src=\"/images/actions/start-stop.png\" /></div><div class=\"button\" onclick=\"javascript: toggle_sscreen('#ss_settings', '', '",'\');"><img src="/images/actions/settings.png" /></div><div class="button" onclick="javascript: ApiDeletePlan(\'','\');"><img src="/images/actions/delete.png" /></div></div>'];